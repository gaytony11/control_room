<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Control Room - Quick Reference Guide</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1100px;
            margin: 40px auto;
            padding: 20px;
            background: #0a0c12;
            color: #cbd5e1;
        }
        h1 { color: #818cf8; border-bottom: 2px solid #818cf8; padding-bottom: 10px; }
        h2 { color: #a78bfa; margin-top: 30px; }
        h3 { color: #c4b5fd; margin-top: 20px; }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: rgba(99,102,241,0.08);
            border: 1px solid rgba(99,102,241,0.2);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }
        .feature-card:hover {
            background: rgba(99,102,241,0.12);
            border-color: rgba(99,102,241,0.4);
            transform: translateY(-2px);
        }
        .feature-title {
            font-size: 18px;
            font-weight: bold;
            color: #818cf8;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .feature-icon {
            font-size: 24px;
        }
        .feature-desc {
            color: #cbd5e1;
            line-height: 1.6;
            margin-bottom: 12px;
        }
        .feature-how {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid #4ade80;
            font-size: 13px;
            line-height: 1.5;
        }
        .feature-how strong {
            color: #4ade80;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        .before, .after {
            padding: 15px;
            border-radius: 8px;
        }
        .before {
            background: rgba(239,68,68,0.1);
            border: 1px solid rgba(239,68,68,0.3);
        }
        .after {
            background: rgba(34,197,94,0.1);
            border: 1px solid rgba(34,197,94,0.3);
        }
        .before h4 { color: #f87171; margin-top: 0; }
        .after h4 { color: #4ade80; margin-top: 0; }
        code {
            background: rgba(255,255,255,0.1);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 13px;
            color: #c4b5fd;
        }
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, #6366f1, #7c3aed);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            margin: 10px 10px 10px 0;
            font-weight: bold;
        }
        .btn:hover { background: linear-gradient(135deg, #7c3aed, #6366f1); }
        .tip {
            background: rgba(251,191,36,0.1);
            border-left: 4px solid #fbbf24;
            padding: 12px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .tip strong { color: #fbbf24; }
        ul { line-height: 1.8; }
        li { margin-bottom: 8px; }
    </style>
</head>
<body>
    <h1>ğŸ¯ Control Room - Quick Reference Guide</h1>
    <p style="font-size: 16px; color: #94a3b8;">February 2026 Update - All New Features</p>

    <a href="http://localhost:8000" class="btn" target="_blank">ğŸš€ Launch Control Room</a>
    <a href="FEBRUARY_2026_UPDATE.md" class="btn" style="background: linear-gradient(135deg, #10b981, #059669);">ğŸ“„ Full Technical Documentation</a>

    <h2>ğŸ†• What's New - 6 Major Features</h2>

    <div class="feature-grid">
        <div class="feature-card">
            <div class="feature-title">
                <span class="feature-icon">ğŸ—ºï¸</span>
                <span>Smooth Pan Navigation</span>
            </div>
            <div class="feature-desc">
                Map now pans smoothly to companies instead of aggressive zoom changes.
            </div>
            <div class="feature-how">
                <strong>How to Use:</strong> Click any company result â†’ Map pans to location maintaining current zoom level
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-title">
                <span class="feature-icon">ğŸ‘¤</span>
                <span>Officer Click Expansion</span>
            </div>
            <div class="feature-desc">
                Click officers to expand and see ALL their company appointments with one-click mapping.
            </div>
            <div class="feature-how">
                <strong>How to Use:</strong> People tab â†’ Search officer name â†’ Click result card â†’ Appointments expand with "â• Add to Map" buttons
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-title">
                <span class="feature-icon">ğŸ“</span>
                <span>Add to Map</span>
            </div>
            <div class="feature-desc">
                Add individual companies to map with connection info, building complex relationship visualizations.
            </div>
            <div class="feature-how">
                <strong>How to Use:</strong> Click "â• Add to Map" button in officer appointments â†’ Company plotted with "Connected to: Officer Name"
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-title">
                <span class="feature-icon">ğŸ”¢</span>
                <span>Multiple Companies</span>
            </div>
            <div class="feature-desc">
                Companies persist on map - new additions don't replace existing ones.
            </div>
            <div class="feature-how">
                <strong>How to Use:</strong> Add multiple companies via any method â†’ All remain visible â†’ Manual clear with confirmation dialog
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-title">
                <span class="feature-icon">ğŸ‘ï¸</span>
                <span>Enhanced Readability</span>
            </div>
            <div class="feature-desc">
                25+ color improvements dramatically increase text visibility and reduce eye strain.
            </div>
            <div class="feature-how">
                <strong>How to Use:</strong> Just use the app! All labels, tabs, status text, and UI elements now have excellent contrast
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-title">
                <span class="feature-icon">ğŸ“„</span>
                <span>Filing History PDF</span>
            </div>
            <div class="feature-desc">
                Download complete company filing history as formatted PDF via API.
            </div>
            <div class="feature-how">
                <strong>How to Use:</strong> Click any company marker â†’ "ğŸ“„ Filing History PDF" button â†’ Multi-page PDF downloads instantly
            </div>
        </div>
    </div>

    <h2>ğŸ“Š Before & After Comparisons</h2>

    <h3>Map Navigation</h3>
    <div class="comparison">
        <div class="before">
            <h4>âŒ BEFORE</h4>
            <ul>
                <li>Clicked company â†’ Aggressive zoom to level 14</li>
                <li>Lost context of surrounding areas</li>
                <li>Jarring zoom animation</li>
            </ul>
        </div>
        <div class="after">
            <h4>âœ… AFTER</h4>
            <ul>
                <li>Clicked company â†’ Smooth pan to location</li>
                <li>Maintains current zoom level</li>
                <li>Better spatial awareness</li>
            </ul>
        </div>
    </div>

    <h3>Officer Investigation</h3>
    <div class="comparison">
        <div class="before">
            <h4>âŒ BEFORE</h4>
            <ul>
                <li>Officer results were static cards</li>
                <li>No way to see their companies</li>
                <li>Had to manually search each company</li>
            </ul>
        </div>
        <div class="after">
            <h4>âœ… AFTER</h4>
            <ul>
                <li>Click officer â†’ Expands with all companies</li>
                <li>Shows appointment details (role, date)</li>
                <li>One-click "Add to Map" per company</li>
            </ul>
        </div>
    </div>

    <h3>Company Management</h3>
    <div class="comparison">
        <div class="before">
            <h4>âŒ BEFORE</h4>
            <ul>
                <li>New search cleared all companies</li>
                <li>Lost previous work</li>
                <li>No relationship mapping</li>
            </ul>
        </div>
        <div class="after">
            <h4>âœ… AFTER</h4>
            <ul>
                <li>Companies persist on map</li>
                <li>Build complex networks</li>
                <li>Connection info in popups</li>
            </ul>
        </div>
    </div>

    <h2>ğŸ¬ Step-by-Step Workflows</h2>

    <h3>Workflow 1: Investigate Person â†’ Build Company Map</h3>
    <div class="feature-how" style="margin: 15px 0;">
        <strong>1.</strong> Go to <strong>ğŸ‘¥ People</strong> tab<br>
        <strong>2.</strong> Search for person name (e.g., "John Smith")<br>
        <strong>3.</strong> Click any officer result card â†’ Expands â–¼<br>
        <strong>4.</strong> See all their company appointments listed<br>
        <strong>5.</strong> Click "â• Add to Map" on interesting companies<br>
        <strong>6.</strong> Map builds up showing their business network<br>
        <strong>7.</strong> Click any marker â†’ See "Connected to: John Smith"<br>
        <strong>8.</strong> Click "ğŸ“„ Filing History PDF" â†’ Download company records
    </div>

    <h3>Workflow 2: Download Filing History for Investigation</h3>
    <div class="feature-how" style="margin: 15px 0;">
        <strong>1.</strong> Search for company (API search or local)<br>
        <strong>2.</strong> Click company marker on map<br>
        <strong>3.</strong> Popup shows company details<br>
        <strong>4.</strong> Click "ğŸ“„ Filing History PDF" button<br>
        <strong>5.</strong> PDF generates client-side (instant)<br>
        <strong>6.</strong> Downloads as <code>FilingHistory_XXXXXXXX_2026-02-10.pdf</code><br>
        <strong>7.</strong> Open PDF â†’ See all filings with dates, types, descriptions<br>
        <strong>8.</strong> Multi-page support with page numbers
    </div>

    <h3>Workflow 3: Multi-Company Network Analysis</h3>
    <div class="feature-how" style="margin: 15px 0;">
        <strong>1.</strong> Search and plot first company<br>
        <strong>2.</strong> View its PSC â†’ Find controlling persons<br>
        <strong>3.</strong> Search those persons in People tab<br>
        <strong>4.</strong> Expand their appointments<br>
        <strong>5.</strong> Add their other companies to map<br>
        <strong>6.</strong> Map now shows the full network<br>
        <strong>7.</strong> Each marker labeled with connections<br>
        <strong>8.</strong> Download filing history for any company of interest
    </div>

    <h2>ğŸ’¡ Pro Tips</h2>

    <div class="tip">
        <strong>ğŸ’¡ Tip:</strong> Companies stay on map until you manually clear them. Build complex investigations by adding companies one by one.
    </div>

    <div class="tip">
        <strong>ğŸ’¡ Tip:</strong> The "Connected to" label in popups helps track which officer/person led you to each company.
    </div>

    <div class="tip">
        <strong>ğŸ’¡ Tip:</strong> Officer appointment expansion shows up to 20 companies. If someone has more, consider searching by their name multiple times with filters.
    </div>

    <div class="tip">
        <strong>ğŸ’¡ Tip:</strong> Filing history PDFs include up to 100 most recent filings. Perfect for compliance checks and due diligence.
    </div>

    <div class="tip">
        <strong>ğŸ’¡ Tip:</strong> Pan-only navigation means you can zoom out for overview, then click companies to center them without losing your zoom level.
    </div>

    <h2>ğŸ”‘ Keyboard Shortcuts & UI Elements</h2>

    <ul>
        <li><strong>Enter</strong> in any search field â†’ Execute search</li>
        <li><strong>Click officer card</strong> â†’ Expand/collapse appointments</li>
        <li><strong>â–¶</strong> icon â†’ Collapsed, click to expand</li>
        <li><strong>â–¼</strong> icon â†’ Expanded, click to collapse</li>
        <li><strong>â• Add to Map</strong> â†’ Green button, adds company individually</li>
        <li><strong>ğŸ“„ Filing History PDF</strong> â†’ Downloads filing history</li>
        <li><strong>View PSC</strong> â†’ Switches to People tab, shows PSC</li>
        <li><strong>Clear All</strong> â†’ Now asks for confirmation first</li>
    </ul>

    <h2>ğŸ¨ Visual Changes</h2>

    <h3>Color Improvements (Better Readability)</h3>
    <ul>
        <li><strong>Labels</strong>: Now <code style="color: #94a3b8;">#94a3b8</code> (was <code style="color: #334155;">#334155</code> - too dark)</li>
        <li><strong>Tabs</strong>: Now <code style="color: #64748b;">#64748b</code> (was <code style="color: #334155;">#334155</code> - hard to read)</li>
        <li><strong>Status Bar</strong>: Now <code style="color: #94a3b8;">#94a3b8</code> (was <code style="color: #334155;">#334155</code> - invisible)</li>
        <li><strong>Popup Labels</strong>: Now <code style="color: #94a3b8;">#94a3b8</code> (was <code style="color: #475569;">#475569</code> - too dim)</li>
        <li><strong>Input Placeholders</strong>: Now <code style="color: #475569;">#475569</code> (was <code style="color: #1e293b;">#1e293b</code> - invisible)</li>
    </ul>

    <h3>New UI Components</h3>
    <ul>
        <li><strong>.officer-card</strong> â†’ Clickable, shows expand icon</li>
        <li><strong>.officer-companies</strong> â†’ Expandable appointment container</li>
        <li><strong>.officer-company-item</strong> â†’ Individual appointment with gradient border</li>
        <li><strong>.btn-add-company</strong> â†’ Green gradient button (emerald theme)</li>
        <li><strong>.expand-icon</strong> â†’ Animated â–¶/â–¼ indicator</li>
    </ul>

    <h2>ğŸ”§ Technical Details</h2>

    <h3>New API Endpoints</h3>
    <ul>
        <li><code>GET /ch/officers/{officer_id}/appointments</code> - Fetch officer's companies</li>
        <li><code>GET /ch/company/{number}/filing-history?items_per_page=100</code> - Fetch filings</li>
    </ul>

    <h3>New Functions</h3>
    <ul>
        <li><code>getOfficerAppointmentsAPI(officerId)</code> - in psc_api.js</li>
        <li><code>getFilingHistoryAPI(companyNumber, limit)</code> - in psc_api.js</li>
        <li><code>downloadFilingHistory(companyNumber, companyName)</code> - in psc_api.js</li>
        <li><code>addCompanyToMap(companyNumber, companyName, personName)</code> - in map.js</li>
    </ul>

    <h3>Modified Functions</h3>
    <ul>
        <li><code>plotCompanies(rows, clearFirst = false)</code> - Now optional clear</li>
        <li><code>runPscSearch()</code> - Officer cards now expandable</li>
        <li><code>clearAll()</code> - Asks for confirmation</li>
    </ul>

    <h2>ğŸ“¦ Files Modified</h2>

    <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
        <thead>
            <tr style="background: rgba(99,102,241,0.1);">
                <th style="padding: 10px; text-align: left; border: 1px solid rgba(99,102,241,0.2);">File</th>
                <th style="padding: 10px; text-align: left; border: 1px solid rgba(99,102,241,0.2);">Changes</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="padding: 8px; border: 1px solid rgba(99,102,241,0.1);"><code>js/map.js</code></td>
                <td style="padding: 8px; border: 1px solid rgba(99,102,241,0.1);">Officer expansion, addCompanyToMap, optional clear</td>
            </tr>
            <tr>
                <td style="padding: 8px; border: 1px solid rgba(99,102,241,0.1);"><code>js/ch_api.js</code></td>
                <td style="padding: 8px; border: 1px solid rgba(99,102,241,0.1);">Pan instead of zoom, filing history button</td>
            </tr>
            <tr>
                <td style="padding: 8px; border: 1px solid rgba(99,102,241,0.1);"><code>js/psc_api.js</code></td>
                <td style="padding: 8px; border: 1px solid rgba(99,102,241,0.1);">Officer appointments, filing history API & PDF</td>
            </tr>
            <tr>
                <td style="padding: 8px; border: 1px solid rgba(99,102,241,0.1);"><code>css/style.css</code></td>
                <td style="padding: 8px; border: 1px solid rgba(99,102,241,0.1);">25+ color improvements, officer card styles</td>
            </tr>
        </tbody>
    </table>

    <h2>âœ… All Features Complete</h2>

    <div style="background: rgba(34,197,94,0.1); border: 2px solid #22c55e; border-radius: 12px; padding: 20px; margin: 30px 0;">
        <h3 style="color: #22c55e; margin-top: 0;">Ready for Use! ğŸ‰</h3>
        <ul style="font-size: 16px;">
            <li>âœ… Pan instead of zoom</li>
            <li>âœ… Officer click expansion</li>
            <li>âœ… Add to Map with connections</li>
            <li>âœ… Multiple companies on map</li>
            <li>âœ… Improved UI readability</li>
            <li>âœ… Filing history PDF download</li>
        </ul>
        <p style="font-size: 16px; margin-bottom: 0;">
            <strong>Status:</strong> All code tested and verified âœ“<br>
            <strong>Errors:</strong> None âœ“<br>
            <strong>Server:</strong> Running at localhost:8000 âœ“
        </p>
    </div>

    <div style="text-align: center; margin: 40px 0;">
        <a href="http://localhost:8000" class="btn" target="_blank" style="font-size: 18px; padding: 16px 32px;">
            ğŸš€ Start Investigating Now
        </a>
    </div>

    <footer style="margin-top: 60px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); text-align: center; color: #64748b; font-size: 12px;">
        <p>Control Room Enhanced Edition â€¢ February 2026</p>
        <p>Built with Companies House API, Leaflet.js, and jsPDF</p>
    </footer>
</body>
</html>
